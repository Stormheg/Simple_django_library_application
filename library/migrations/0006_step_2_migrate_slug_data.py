# Generated by Django 4.1.7 on 2023-04-07 09:14

from django.db import migrations
from django.utils.text import slugify

# # Forwards
# name = "Storm Heg"

# # some code to split the names

# first_name = "Storm"
# last_name = "Heg"

# # Backwards / reverse

# first_name = "Storm"
# last_name = "Heg"

# # some code to merge these names
# name = "Storm Heg"


# We cannot do this
# from library.models import Book 

def forwards(apps, schema_editor):
    Book = apps.get_model("library", "Book")
    Author = apps.get_model("library", "Author")
    Collection = apps.get_model("library", "Collection")

    for single_book in Book.objects.all():
        single_book.slug = slugify(single_book.title)
        single_book.save()

    for single_author in Author.objects.all():
        single_author.slug = slugify(single_author.name)
        single_author.save()

    for single_collection in Collection.objects.all():
        single_collection.slug = slugify(single_collection.name)
        single_collection.save()


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0005_step_1_add_null_slug_field'),
    ]

    operations = [
        migrations.RunPython(code=forwards, reverse_code=migrations.RunPython.noop)
    ]
